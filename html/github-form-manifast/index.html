<!-- NOTE: ai generated javascript -->

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GitHub App Creator</title>
  </head>
  <body>
    <h1>GitHub App Creator</h1>
    <p>Paste JSON:</p>
    <textarea
      id="jsonInput"
      style="width: 100%; height: 400px; font-family: monospace"
    ></textarea>
    <br />
    <button id="createBtn">Create App</button>
    <div id="info"></div>

    <script>
      document.getElementById("createBtn").onclick = function () {
        const input = document.getElementById("jsonInput").value.trim();
        if (!input) {
          show("Paste JSON first");
          return;
        }

        let data;
        try {
          data = JSON.parse(input);
        } catch (e) {
          show("Invalid JSON");
          return;
        }

        const manifest = data.manifest;
        const state = data.state;

        if (!manifest || !state) {
          show("Need manifest + state");
          return;
        }

        const manifestStr = JSON.stringify(manifest).replace(/'/g, "&#39;");
        const formHtml =
          '<!DOCTYPE html><html><body><form id="f" action="https://github.com/settings/apps/new?state=' +
          encodeURIComponent(state) +
          '" method="post"><input type="hidden" name="manifest" value=\'' +
          manifestStr +
          '\'></form><script>document.getElementById("f").submit();<\/script></body></html>';

        const win = window.open("", "_blank");
        win.document.write(formHtml);
        win.document.close();

        show("Check new tab");
      };

      function show(msg) {
        document.getElementById("info").textContent = msg;
      }
    </script>
  </body>
</html>
